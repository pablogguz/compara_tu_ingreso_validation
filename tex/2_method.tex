
\subsection{Background}

The study of income distributions has been a cornerstone of economic research. A key empirical regularity in this literature is that income distributions tend to approximate a log-normal distribution \citep{aitchison1957lognormal}. This pattern has been documented across different contexts and time periods, leading to its establishment as a stylized fact in economic analysis \citep{lopez2006normal}.

The theoretical foundations for log-normality rest on multiple reinforcing mechanisms. First, individual earnings are determined by the multiplicative interaction of factors like human capital, experience, local labor market conditions, and individual productivity \citep{neal2000theories}. Second, Gibrat's law of proportionate effect demonstrates how such multiplicative processes naturally generate log-normal distributions \citep{gibrat1931inegalites}. This theoretical prediction is particularly robust within demographically and geographically homogeneous groups \citep{battistin2009consumption}.
The spatial dimension adds another layer to this analysis. \cite{sampson2012great} demonstrates that residential location influences economic outcomes through multiple channels, including peer effects, social networks, and institutional quality. 

\cite{durlauf2004neighborhood} formalizes this insight, developing a theoretical framework explaining how local social interactions generate correlation in economic outcomes within neighborhoods. These spatial effects are further reinforced through local labor market networks \citep{topa2015neighborhood}, creating a mechanism where geographic proximity translates into similar economic outcomes. When populations share similar characteristics and face common local conditions, their incomes tend to follow more precisely a log-normal distribution than in more heterogeneous populations \citep{mitzenmacher2004brief}.

\paragraph{Mixtures} These insights about local homogeneity and overall heterogeneity suggest the utility of mixture distributions. \cite{parker2012measuring} demonstrates that mixtures of log-normal distributions can accurately capture both within-group and between-group inequality, providing support for approaches that combine local distributional estimates. This is particularly relevant when working with administrative data that provides detailed geographic information but may lack individual-level granularity. The mixture approach allows us to leverage the stronger log-normality at local levels while accommodating the greater complexity of aggregate distributions.

\paragraph{Limitations} While the log-normal distribution provides a good approximation, several studies have documented systematic deviations, particularly in the tails. \cite{clementi2016some} find that while the body of the income distribution is well-approximated by a log-normal, the upper tail often follows a Pareto distribution. This "double distribution" pattern suggests the need for caution when using log-normal approximations, particularly when analyzing high-income populations.

\subsection{Empirical approach}

I estimate the national income distribution by exploiting the granular structure of census tract data and the theoretical properties of income distributions. My approach leverages two key insights: (1) income distributions within small geographic units tend to follow log-normal distributions more closely than in larger areas, and (2) the overall distribution can be approximated by a mixture of these local distributions.

Consider a census tract $j$ with an observed mean income $\mu_j$ and Gini coefficient $G_j$. Under the log-normality assumption, if income $X$ follows a log-normal distribution with parameters $(\nu_j, \sigma_j^2)$, then:

\begin{equation}
\ln(X) \sim N(\nu_j, \sigma_j^2)
\end{equation}

The relationship between these parameters and the observed statistics is thus given by:

\begin{equation}
\mu_j = \exp\left(\nu_j + \frac{\sigma_j^2}{2}\right)
\end{equation}

\begin{equation}
G_j = 2\Phi\left(\frac{\sigma_j}{\sqrt{2}}\right) - 1
\end{equation}

where $\Phi(\cdot)$ is the standard normal cumulative distribution function. From the observed Gini coefficient, I can recover $\sigma_j$:

\begin{equation}
\sigma_j = \sqrt{2}\Phi^{-1}\left(\frac{G_j + 1}{2}\right)
\end{equation}

Given $\sigma_j$ and $\mu_j$, the distribution for census tract $j$ is fully identified, , as $\nu_j$ can be solved analytically. I then estimate the national distribution as a population-weighted mixture of these local log-normal distributions. For a given income level $x$, the density is given by:

\begin{equation}
f(x) = \sum_{j=1}^{J} w_j f_j(x|\nu_j,\sigma_j^2)
\end{equation}

where $w_j$ is tract $j$'s population share and $f_j(\cdot|\nu_j,\sigma_j^2)$ is the log-normal density function with parameters $(\nu_j,\sigma_j^2)$.

To calculate percentiles of the national distribution, I solve:

\begin{equation}
p = F(q_p) = \sum_{j=1}^{J} w_j \Phi\left(\frac{\ln(q_p) - \nu_j}{\sigma_j}\right)
\end{equation}

where $q_p$ is the $p^{th}$ percentile and $F(\cdot)$ is the cumulative distribution function of the mixture. I use numerical root-finding methods to find the value of $q_p$ that satisfies $F(q_p) - p = 0$ within a bounded interval.

This approach has several advantages. First, it respects the theoretical properties of income distributions at local levels where populations are more homogeneous. Second, it preserves tract-level moments while allowing for heterogeneity across tracts. Third, it provides a flexible framework for calculating any distributional statistic of interest.

\paragraph{Missing outcomes} For census tracts with missing Gini coefficients (approximately 5.2\% of the sample), I estimate them using machine learning methods. Specifically, I train an XGBoost model using the following demographic predictors: dependency ratio (ratio of population under 18 and over 65 to working-age population), mean age, percentage of single-person households, mean logged equivalised income, and province fixeed effects. Model performance is validated using a 5-fold cross-validation procedure. The XGBoost model is trained using default hyperparameters without grid search or additional tuning. Based on the cross-validation results, the XGBoost model demonstrates superior predictive performance compared to a baseline OLS model.

\paragraph{Validation} To validate the log-normality assumption at the tract level, I compare observed distributional statistics with their theoretical counterparts under log-normality. For each tract $j$, I first recover the parameters of the theoretical log-normal distribution $(\nu_j, \sigma_j)$ using the observed mean income and Gini coefficient. Then, I calculate two key predicted statistics: the P80/P20 ratio and the median income. Under log-normality, these are given by:

\begin{equation}
\text{P80/P20}_j = \exp(\sigma_j(\Phi^{-1}(0.8) - \Phi^{-1}(0.2)))
\end{equation}

\begin{equation}
\text{P50}_j = \exp(\nu_j)
\end{equation}

To assess the fit, I estimate binned regressions of the form:

\begin{equation}
y_j^{\text{predicted}} = \alpha + \beta y_j^{\text{observed}} + \epsilon_j
\end{equation}

